<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>ganelon.web.actions documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Ganelon 0.7-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="ganelon.util.html"><span>ganelon.util</span></a></li><li><a href="ganelon.util.datetime.html"><span>ganelon.util.datetime</span></a></li><li><a href="ganelon.util.logging.html"><span>ganelon.util.logging</span></a></li><li class="current"><a href="ganelon.web.actions.html"><span>ganelon.web.actions</span></a></li><li><a href="ganelon.web.app.html"><span>ganelon.web.app</span></a></li><li><a href="ganelon.web.dyna-routes.html"><span>ganelon.web.dyna-routes</span></a></li><li><a href="ganelon.web.middleware.html"><span>ganelon.web.middleware</span></a></li><li><a href="ganelon.web.ui-operations.html"><span>ganelon.web.ui-operations</span></a></li><li><a href="ganelon.web.widgets.html"><span>ganelon.web.widgets</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="ganelon.web.actions.html#var-*widget-id*"><span>*widget-id*</span></a></li><li><a href="ganelon.web.actions.html#var-ACTION"><span>ACTION</span></a></li><li><a href="ganelon.web.actions.html#var-JSONACTION"><span>JSONACTION</span></a></li><li><a href="ganelon.web.actions.html#var-WIDGETACTION"><span>WIDGETACTION</span></a></li><li><a href="ganelon.web.actions.html#var-defaction"><span>defaction</span></a></li><li><a href="ganelon.web.actions.html#var-defjsonaction"><span>defjsonaction</span></a></li><li><a href="ganelon.web.actions.html#var-defwidgetaction"><span>defwidgetaction</span></a></li><li><a href="ganelon.web.actions.html#var-javascript-action-interface"><span>javascript-action-interface</span></a></li><li><a href="ganelon.web.actions.html#var-javascript-actions-handler"><span>javascript-actions-handler</span></a></li><li><a href="ganelon.web.actions.html#var-put-operation%21"><span>put-operation!</span></a></li><li><a href="ganelon.web.actions.html#var-wrap-set-widget-id"><span>wrap-set-widget-id</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>ganelon.web.actions documentation</h2><pre class="doc">This namespace contains actions support functions and macros.
</pre><div class="public" id="var-*widget-id*"><h3>*widget-id*</h3><div class="usage"></div><pre class="doc">Id of a current widget, for example provided as a 'widget-id' GET/POST parameter.
</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L12">Source</a></div></div><div class="public" id="var-ACTION"><h3>ACTION</h3><h4 class="macro">macro</h4><div class="usage"><code>(ACTION name params &amp; body)</code></div><pre class="doc">Define and register basic action, by adding: logging and exception handling to compojure.core/ANY handler with path
composed from '/a/' prefix and action name.

Example:

(ACTION &quot;sample4&quot; [x y]
  (noir.response/json {:x x :y y :z &quot;!&quot;}))

This macro does not register handler with ganelon.web.dyna-routes.</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L18">Source</a></div></div><div class="public" id="var-JSONACTION"><h3>JSONACTION</h3><h4 class="macro">macro</h4><div class="usage"><code>(JSONACTION name params &amp; body)</code></div><pre class="doc">Define and register JSON action, by adding: logging and exception handling to compojure.core/ANY handler with path
composed from '/a/' prefix and action name.

If the body result is a not collection or is a map, it is wrapped in a vector. The final result is passed to
noir.response/json function.

Example:

(JSONACTION &quot;sample4&quot; [x y]
  {:x x :y y :z &quot;!&quot;})

This macro does not register handler with ganelon.web.dyna-routes.</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L66">Source</a></div></div><div class="public" id="var-WIDGETACTION"><h3>WIDGETACTION</h3><h4 class="macro">macro</h4><div class="usage"><code>(WIDGETACTION name params &amp; body)</code></div><pre class="doc">Define and register widget action, by adding: logging and exception handling to compojure.core/ANY handler with path
composed from '/a/' prefix and action name.

The result of body is used as a value for ganelon.web.ui-operations/replace-with. The id is taken from *widget-id*
special variable. The operation is wrapped with JSONACTION macro.

If ~body returns nil, the widget is not updated.

Example:

(WIDGETACTION &quot;sample4&quot; [x y]
  (str &quot;&lt;p&gt;Test!&quot; (int x) &quot;&lt;/p&gt;&quot;))

This macro does not register handler with ganelon.web.dyna-routes.</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L89">Source</a></div></div><div class="public" id="var-defaction"><h3>defaction</h3><h4 class="macro">macro</h4><div class="usage"><code>(defaction name params &amp; body)</code></div><pre class="doc">This macro wraps ACTION with ganelon.web.dyna-routes/setroute! function, registering action for a default
dyna-routes handler.

Example:

(defaction &quot;sample4&quot; [x y]
  (noir.response/json {:x x :y y :z &quot;!&quot;}))</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L113">Source</a></div></div><div class="public" id="var-defjsonaction"><h3>defjsonaction</h3><h4 class="macro">macro</h4><div class="usage"><code>(defjsonaction name params &amp; body)</code></div><pre class="doc">This macro wraps JSONACTION with ganelon.web.dyna-routes/setroute! function, registering action for a default
dyna-routes handler.

Example:

(defjsonaction &quot;sample4&quot; [x y]
  {:x x :y y :z &quot;!&quot;})</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L125">Source</a></div></div><div class="public" id="var-defwidgetaction"><h3>defwidgetaction</h3><h4 class="macro">macro</h4><div class="usage"><code>(defwidgetaction name params &amp; body)</code></div><pre class="doc">This macro wraps JSONACTION with ganelon.web.dyna-routes/setroute! function, registering action for a default
dyna-routes handler.

Example:

(defwidgetaction &quot;sample4&quot; [x y]
  (str &quot;&lt;p&gt;Test!&quot; (int x) &quot;&lt;/p&gt;&quot;))</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L137">Source</a></div></div><div class="public" id="var-javascript-action-interface"><h3>javascript-action-interface</h3><div class="usage"><code>(javascript-action-interface [name params])</code></div><pre class="doc">Generate action interface for JavaScript. Dash (-) and slash (/) characters are translated to an underscore (_).
If the action does not use widget-id parameter, it will be added implicitly at the end of params.

Example:

(javascript-action-interface ['test-action ['widget-id 'x 'y]])
;=&gt; &quot;GanelonAction.test_action=function(widget_id,x,y, onSuccess, onError){Ganelon.performAction('test-action','widget-id='+encodeURIComponent(widget_id)+'&amp;x='+encodeURIComponent(x)+'&amp;y='+encodeURIComponent(y)+'',onSuccess,onError);};&quot;
(javascript-action-interface ['test-action ['x 'y 'z]])
;=&gt; &quot;GanelonAction.test_action=function(x,y,z,widget_id, onSuccess, onError){Ganelon.performAction('test-action','x='+encodeURIComponent(x)+'&amp;y='+encodeURIComponent(y)+'&amp;z='+encodeURIComponent(z)+'&amp;widget-id='+encodeURIComponent(widget_id)+'',onSuccess,onError);};&quot;</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L155">Source</a></div></div><div class="public" id="var-javascript-actions-handler"><h3>javascript-actions-handler</h3><div class="usage"><code>(javascript-actions-handler)</code></div><pre class="doc">Ring handler that returns a JavaScript file containing action interfaces for all registered actions.
Usually, it is more convienient to use ganelon.web.app/javascript-actions-handler, which provides a route
to this handler for GET on /ganelon/actions.js.

Example use:

(compojure/GET &quot;/ganelon/actions.js&quot; []
    (actions/javascript-actions-handler))</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L175">Source</a></div></div><div class="public" id="var-put-operation%21"><h3>put-operation!</h3><div class="usage"><code>(put-operation! operation)</code></div><pre class="doc">Register operation to be returned as a part of the action response. Returns nil in case the put-operation!
is used at the end of an action body.

Example:

(actions/put-operation! (ui/notification &quot;Success&quot;
  (h/html &quot;Message set to: &quot; [:b (hiccup.util/escape-html msg)])))</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L54">Source</a></div></div><div class="public" id="var-wrap-set-widget-id"><h3>wrap-set-widget-id</h3><div class="usage"><code>(wrap-set-widget-id app)</code></div><pre class="doc">Bind 'widget-id' req parameter to a special variable *widget-id*.

This middleware requires wrap-keyword-params.</pre><div class="src-link"><a href="http://github.com/tlipski/ganelon/blob/master/src/ganelon/web/actions.clj#L45">Source</a></div></div></div></body></html>